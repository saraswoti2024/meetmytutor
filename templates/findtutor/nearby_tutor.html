{% extends "base.html" %}
{% block content %}
{% load static %}

<section class="py-12 bg-gradient-to-br from-indigo-50 to-purple-50">
  <div class="max-w-6xl mx-auto px-6">
    <h1 class="text-4xl font-extrabold text-center text-gray-900 mb-4 animate-fade-in-down">Find Your Perfect Nearby Tutor</h1>
    <p class="text-xl text-center text-gray-600 mb-10 animate-fade-in-down delay-100">Unlock your potential with expert guidance.</p>

    <div class="bg-white rounded-xl shadow-lg p-8 mb-16 border border-gray-100 animate-slide-in-up">
      <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Search for Tutors</h2>
      <form class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6" method="GET" action="">
        {% csrf_token %}
        <div>
          <label  class="block text-sm font-medium text-gray-700 mb-2">Education Level</label>
          <select
            name="education_level"
            class="w-full p-3 rounded-lg border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200 ease-in-out appearance-none bg-white pr-8"
          >
            <option value="" {% if not selected_education_level %}selected{% endif %} disabled>Select Level</option>
            <option value="basic_1_5" {% if selected_education_level == 'basic_1_5' %}selected{% endif %}>Basic Education (Grade 1-5)</option>
            <option value="basic_6_8" {% if selected_education_level == 'basic_6_8' %}selected{% endif %}>Basic Education (Grade 6-8)</option>
            <option value="secondary_9_10" {% if selected_education_level == 'secondary_9_10' %}selected{% endif %}>Secondary Education (Grade 9-10)</option>
            <option value="secondary_11_12" {% if selected_education_level == 'secondary_11_12' %}selected{% endif %}>Secondary Education (Grade 11-12)</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Subject</label>
          <select
            name="subject"
            class="w-full p-3 rounded-lg border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200 ease-in-out appearance-none bg-white pr-8"
          >
            <option value="" {% if not selected_subject %}selected{% endif %} disabled>Select Level</option>

            {% for i in all_subjects  %}
            <option value="{{i.subject_name}}" {% if selected_subject == i.subject_name %}selected{% endif %}>{{i.subject_name}}</option>
            {% endfor %}

          </select>
        </div>

        <div class="lg:col-span-2">
          <label for="tutorName" class="block text-sm font-medium text-gray-700 mb-2">Tutor Name (Optional)</label>
          <input
            type="text"
            id="tutorName"
            name="tutorname"
            placeholder="e.g., Jane Doe"
            class="w-full p-3 rounded-lg border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200 ease-in-out"
            value="{{ searched_tutor_name|default:'' }}"
          />
        </div>

        <div class="md:col-span-2 lg:col-span-5 flex justify-center mt-4 space-x-4">
          <button
            type="submit"
            class="w-full md:w-auto bg-gradient-to-r from-indigo-600 to-purple-700 hover:from-indigo-700 hover:to-purple-800 text-white font-bold rounded-lg px-8 py-3 shadow-md hover:shadow-lg transition transform hover:-translate-y-1 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 flex items-center justify-center gap-2"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
            </svg>
            Search Tutors
          </button>
          <a
            href="{% url 'nearby_tutor' %}"
            class="w-full md:w-auto bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold rounded-lg px-8 py-3 shadow-md hover:shadow-lg transition transform hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 flex items-center justify-center gap-2"
          >
            Reset Search / All Nearby Tutors
          </a>
        </div>
      </form>
    </div>
  </div>
</section>

<section class="bg-white py-12">
  <div class="max-w-6xl mx-auto px-6">
    <h2 class="text-3xl font-bold text-gray-900 mb-10 text-center animate-fade-in">All Tutors</h2>
<!-- card -->
    {% if tutorlist %}
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
            {% for tutor in tutorlist %}
            <div
                class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden transform transition-transform duration-300 hover:scale-[1.03] hover:shadow-xl group"
            >
                <div class="relative w-full h-48 sm:h-56 overflow-hidden">
                    {% if tutor.profile_img %}
                    <img
                        src="{{tutor.profile_img.url}}"
                        alt="{{ tutor.name }} Profile Picture"
                        class="w-full h-full object-cover object-center transform transition-transform duration-300 group-hover:scale-105"
                        loading="lazy"
                    />
                    {% else %}
                    <img
                    src="{% static 'images/default.jpg' %}"
                    alt="{{ tutor.name }} Profile Picture"
                    class="w-full h-full object-cover object-center transform transition-transform duration-300 group-hover:scale-105"
                    loading="lazy"
                    />
                    {% endif %}
                </div>

                <div class="p-6">
                    <h3 class="text-2xl font-extrabold text-gray-900 mb-2 truncate" title="{{ tutor.user.first_name }} {{ tutor.user.last_name }}">{{tutor.user.first_name}} {{tutor.user.last_name}}</h3>
                
                    <p class="text-gray-700 mb-1">
                        <span class="font-semibold text-gray-800">Teaches:</span>
                        {% if tutor.education_data %}
                        {% for item in tutor.education_data %}
                            <span class="inline-block bg-indigo-100 text-indigo-700 text-sm font-medium px-2 py-1 rounded mr-2 mt-1">
                                {% if item.level == 'basic_1_5' %} Basic (Grade 1–5)
                                {% elif item.level == 'basic_6_8' %} Basic (Grade 6–8)
                                {% elif item.level == 'secondary_9_10' %} Secondary (Grade 9–10)
                                {% elif item.level == 'secondary_11_12' %} Secondary (Grade 11–12)
                                {% else %} {{ item.level }}
                                {% endif %}
                            </span>
                        {% endfor %}
                        {% else %}
                        <span class="text-indigo-600">Not specified</span>
                        {% endif %}
                    </p>
                    
                    <p class="text-gray-600 text-sm mb-2">
                        <span class="font-semibold text-gray-800">Qualification:</span> {{ tutor.qualification }}
                    </p>

                    <div class="flex items-center justify-between text-base mb-3">
                        <p class="text-gray-700">
                            <span class="font-semibold text-gray-800">Rate:</span>
                            <span class="text-green-600 font-bold">Rs.{{ tutor.session_price}}/hr</span>
                        </p>
                        <p class="text-gray-700">
                            <span class="font-semibold text-gray-800">Location:</span>
                            <span class="text-purple-600">{{ tutor.district }}, Nepal</span>
                        </p>
                    </div>
                    <a href="#" class="block w-full text-center bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg px-6 py-3 transition duration-300 ease-in-out transform hover:-translate-y-0.5 shadow-md">
                        View Profile
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
        <!-- card ends -->
    {% else %}
        <p class="text-center text-gray-600 text-lg">No tutors found !</p>
    {% endif %}
  </div>
</section>
{% endblock content %}